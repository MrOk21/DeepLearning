Hurricane matthew weakens off u.s. coast after ravaging haiti