Thousands gather to mourn at slain nypd officer's funeral