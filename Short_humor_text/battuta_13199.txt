Supreme court backs church in key religious rights case