Stung by criticism, obama preps sweeping defense of his foreign policy