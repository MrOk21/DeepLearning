Airport shooting suspect checked gun, despite mental health issues