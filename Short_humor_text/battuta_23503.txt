Thousands lose right to vote under 'incompetence' laws