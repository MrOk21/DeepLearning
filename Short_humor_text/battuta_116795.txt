Uber's self-driving program at risk as judge considers heated case brought by rival