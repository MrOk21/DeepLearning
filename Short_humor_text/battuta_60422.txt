North korea threatens 'resolute and merciless response,' even 'all out war'